import{az as k,r as B,aW as f,j as u,k as Q,d as t,O as F,l as c,Q as m,I as i,bl as D,F as v,aE as y,aU as q,N as L,aN as p,J as n,L as _,aK as N,H as V,b5 as A,aD as P,P as T}from"./index.f2026c19.js";import{Q as $}from"./QSelect.5d66f651.js";import{Q as E,a as x,C as O}from"./ClosePopup.b1e56300.js";import{Q as w}from"./QImg.5f752c58.js";import{Q as G}from"./QForm.2e00fe0f.js";import{Q as H,a as g}from"./QTable.6f79e516.js";import{Q as z}from"./QBadge.64b8500c.js";import{u as J}from"./use-quasar.e2364d03.js";import"./QItem.a740bfc7.js";import"./QItemSection.36677e1e.js";import"./QItemLabel.71fd93ae.js";import"./QMenu.8ed2d6ad.js";import"./rtl.b51694b1.js";import"./format.3e32b8d9.js";import"./QList.b3260b28.js";const K=c("h5",{class:"text-center q-pa-lg"}," \u7968\u5238\u7BA1\u7406 ",-1),M={class:"row justify-start q-pa-md"},R={class:"text-h6 text-center"},W={class:"row q-pa-md"},X={class:"row q-pa-md"},Y={class:"q-pa-md q-gutter-xl"},fe={__name:"TicketsPage",setup(Z){const s=J(),S=["\u666F\u9EDE","\u6236\u5916\uFF06\u6D3B\u52D5","\u6587\u5316\u9AD4\u9A57","\u5C55\u6F14\u6D3B\u52D5","\u65C5\u904A\u901A\u7968","\u884C\u7A0B","\u5176\u4ED6"],d={required(l){return!!l||"\u6B04\u4F4D\u5FC5\u586B"},price(l){return l>=0||"\u50F9\u683C\u932F\u8AA4"}},r=k([]),b=B(""),C=[{name:"image",label:"\u5716\u7247",align:"left",field:l=>l.image},{name:"name",label:"\u540D\u7A31",align:"left",field:l=>l.name,sortable:!0},{name:"price",label:"\u50F9\u683C",align:"left",field:l=>l.price,sortable:!0},{name:"category",label:"\u7A2E\u985E",align:"left",field:l=>l.category},{name:"sell",label:"\u4E0A\u67B6\u72C0\u614B",align:"left",field:l=>l.sell,sortable:!0},{name:"edit",label:"\u7DE8\u8F2F",align:"left",field:l=>l.edit},{name:"delete",label:"\u522A\u9664",align:"left",field:l=>l.delete}],e=k({_id:"",name:"",price:0,subtitle:"",description:"",image:void 0,images:[],sell:!1,category:"",location:"",loading:"",dialog:!1,idx:-1}),h=l=>{l===-1?(e._id="",e.name="",e.price=0,e.subtitle="",e.description="",e.location="",e.image=void 0,e.images=[],e.sell=!1,e.loading=!1,e.idx=-1):(e._id=r[l]._id,e.name=r[l].name,e.price=r[l].price,e.subtitle=r[l].subtitle,e.description=r[l].description,e.location=r[l].location,e.image=r[l].image,e.images=r[l].images,e.sell=r[l].sell,e.category=r[l].category,e.loading=!1,e.idx=l),e.dialog=!0},U=async()=>{e.loading=!0;const l=new FormData;l.append("name",e.name),l.append("price",e.price),l.append("subtitle",e.subtitle),l.append("description",e.description),l.append("location",e.location),l.append("image",e.image);for(const o of e.images)l.append("images",o);l.append("sell",e.sell),l.append("category",e.category);try{if(e._id.length===0){const{data:o}=await f.post("/products",l);r.push(o.result),s.notify({position:"center",color:"positive",message:"\u65B0\u589E\u6210\u529F",icon:"check_circle",timeout:2e3})}else{const{data:o}=await f.patch("/products/"+e._id,l);r[e.idx]=o.result,s.notify({position:"center",color:"positive",message:"\u7DE8\u8F2F\u6210\u529F",icon:"check_circle",timeout:2e3})}e.dialog=!1}catch{s.notify({position:"center",color:"negative",message:"\u5931\u6557",icon:"check_circle",timeout:2e3})}},j=async l=>{try{await f.patch("/products/delete/"+l,{status:1});const o=r.findIndex(a=>a._id===l);r.splice(o,1),s.notify({position:"center",color:"positive",message:"\u522A\u9664\u6210\u529F",icon:"check_circle",timeout:2e3})}catch{s.notify({position:"center",color:"negative",message:"\u5931\u6557",icon:"check_circle",timeout:2e3})}};return(async()=>{try{const{data:l}=await f.get("/products/all");r.push(...l.result)}catch{console.log("\u53D6\u5F97\u5546\u54C1\u5931\u6557")}})(),(l,o)=>(u(),Q(v,null,[K,t(F,{inset:""}),c("div",M,[t(m,{color:"accent","text-color":"white",label:"\u65B0\u589E\u7968\u5238",onClick:o[0]||(o[0]=a=>h(-1))})]),t(D,{modelValue:e.dialog,"onUpdate:modelValue":o[10]||(o[10]=a=>e.dialog=a),persistent:""},{default:i(()=>[t(y,{class:"my-card",style:{"min-width":"600px"}},{default:i(()=>[t(G,{onSubmit:U},{default:i(()=>[t(q,{class:"bg-secondary"},{default:i(()=>[c("div",R,L(e._id.length>0?"\u7DE8\u8F2F\u7968\u5238":"\u65B0\u589E\u7968\u5238"),1)]),_:1}),t(q,{class:"flex justify-center items-center row"},{default:i(()=>[t(p,{modelValue:e.name,"onUpdate:modelValue":o[1]||(o[1]=a=>e.name=a),outlined:"",type:"text",label:"\u7968\u5238\u540D\u7A31",rules:[d.required],"lazy-rules":"",class:"col-6 q-pa-md",color:"primary"},null,8,["modelValue","rules"]),t(p,{modelValue:e.price,"onUpdate:modelValue":o[2]||(o[2]=a=>e.price=a),outlined:"",type:"number",label:"\u7968\u5238\u50F9\u683C",rules:[d.required,d.price],"lazy-rules":"",class:"col-6 q-pa-lg",min:"0"},null,8,["modelValue","rules"]),t($,{modelValue:e.category,"onUpdate:modelValue":o[3]||(o[3]=a=>e.category=a),options:S,rules:[d.required],label:"\u7968\u5238\u5206\u985E","lazy-rules":"",class:"col-12 q-pa-md",outlined:""},null,8,["modelValue","rules"]),t(p,{modelValue:e.location,"onUpdate:modelValue":o[4]||(o[4]=a=>e.location=a),outlined:"",autogrow:"",type:"textarea",label:"\u7968\u5238\u5730\u9EDE",rules:[d.required],"lazy-rules":"",class:"col-12 q-pa-md"},null,8,["modelValue","rules"]),t(p,{modelValue:e.subtitle,"onUpdate:modelValue":o[5]||(o[5]=a=>e.subtitle=a),outlined:"",autogrow:"",type:"textarea",label:"\u7968\u5238\u526F\u6A19\u984C",rules:[d.required],"lazy-rules":"",class:"col-12 q-pa-md"},null,8,["modelValue","rules"]),t(E,{modelValue:e.description,"onUpdate:modelValue":o[6]||(o[6]=a=>e.description=a),dense:n(s).screen.lt.md,toolbar:[[{label:n(s).lang.editor.align,icon:n(s).iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]},{label:n(s).lang.editor.align,icon:n(s).iconSet.editor.align,fixedLabel:!0,options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],["print","fullscreen"],[{label:n(s).lang.editor.formatting,icon:n(s).iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:n(s).lang.editor.fontSize,icon:n(s).iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:n(s).lang.editor.defaultFont,icon:n(s).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered","outdent","indent"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["modelValue","dense","toolbar"]),t(x,{modelValue:e.image,"onUpdate:modelValue":o[7]||(o[7]=a=>e.image=a),class:"col-12 q-pa-md justify-center",removable:"",label:"\u9078\u64C7\u5716\u7247",outlined:"","use-chips":""},{prepend:i(()=>[t(_,{name:"attach_file"})]),_:1},8,["modelValue"]),c("div",W,[t(y,{class:"my-card col",flat:"",bordered:""},{default:i(()=>[t(w,{src:e.image,width:"100px"},null,8,["src"])]),_:1})]),t(x,{modelValue:e.images,"onUpdate:modelValue":o[8]||(o[8]=a=>e.images=a),class:"col-12 q-pa-md justify-center",removable:"",multiple:"",label:"\u9078\u64C7\u591A\u5F35\u5716\u7247",outlined:"","use-chips":""},{prepend:i(()=>[t(_,{name:"attach_file"})]),_:1},8,["modelValue"]),c("div",X,[(u(!0),Q(v,null,N(e.images,a=>(u(),V(y,{key:a,class:"my-card col",flat:"",bordered:""},{default:i(()=>[t(w,{src:a,width:"100px"},null,8,["src"])]),_:2},1024))),128))]),t(A,{modelValue:e.sell,"onUpdate:modelValue":o[9]||(o[9]=a=>e.sell=a),label:"\u4E0A\u67B6",class:"col-12 q-pa-md justify-center"},null,8,["modelValue"])]),_:1}),t(P,{align:"right",class:"text-primary q-pa-md"},{default:i(()=>[T(t(m,{flat:"",label:"\u53D6\u6D88",disable:e.loading},null,8,["disable"]),[[O]]),t(m,{flat:"",label:"\u9001\u51FA",type:"submit",loading:e.loading},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),c("div",Y,[t(H,{rows:r,columns:C,"row-key":"_id","rows-per-page-options":[4,10],filter:b.value},{"body-cell-image":i(a=>[t(g,null,{default:i(()=>[t(w,{style:{height:"120px"},src:a.row.image},null,8,["src"])]),_:2},1024)]),"top-right":i(()=>[t(g,null,{default:i(()=>[t(p,{modelValue:b.value,"onUpdate:modelValue":o[11]||(o[11]=a=>b.value=a),borderless:"",dense:"",debounce:"300",placeholder:"Search"},{append:i(()=>[t(_,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),"body-cell-sell":i(a=>[t(g,null,{default:i(()=>[a.row.sell?(u(),V(z,{key:0,color:"primary",label:"\u4E0A\u67B6\u4E2D"})):(u(),V(z,{key:1,color:"accent",label:"\u5DF2\u4E0B\u67B6"}))]),_:2},1024)]),"body-cell-edit":i(a=>[t(g,null,{default:i(()=>[t(m,{round:"",color:"primary",icon:"edit",onClick:I=>h(r.indexOf(a.row))},null,8,["onClick"])]),_:2},1024)]),"body-cell-delete":i(a=>[t(g,null,{default:i(()=>[t(m,{round:"",color:"accent",icon:"delete",onClick:I=>j(a.row._id)},null,8,["onClick"])]),_:2},1024)]),_:1},8,["rows","filter"])])],64))}};export{fe as default};
